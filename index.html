<html>
  <head>
    <meta charset="utf-8">
    <script src="https://aframe.io/releases/0.6.1/aframe.min.js"></script>
  </head>
  <body>
    <a-scene travel-node-default="axis: x,y,z; offsetY: 0.75">

      <!-- Assets Management -->
      <a-assets>
        <!-- Bed -->
        <a-asset-item id="bed-mtl" src="./blocks/bed/materials.mtl"></a-asset-item>
        <a-asset-item id="bed-obj" src="./blocks/bed/model.obj"></a-asset-item>
        <!-- Night Stand -->
        <a-asset-item id="nightstand-mtl" src="./blocks/nightstand/materials.mtl"></a-asset-item>
        <a-asset-item id="nightstand-obj" src="./blocks/nightstand/model.obj"></a-asset-item>
        <!-- Toilet -->
        <a-asset-item id="toilet-mtl" src="./blocks/toilet/materials.mtl"></a-asset-item>
        <a-asset-item id="toilet-obj" src="./blocks/toilet/model.obj"></a-asset-item>
        <!-- Toilet Paper -->
        <a-asset-item id="toilet_paper-mtl" src="./blocks/toilet_paper/materials.mtl"></a-asset-item>
        <a-asset-item id="toilet_paper-obj" src="./blocks/toilet_paper/model.obj"></a-asset-item>
        <!-- Door -->
        <a-asset-item id="door-mtl" src="./blocks/door/materials.mtl"></a-asset-item>
        <a-asset-item id="door-obj" src="./blocks/door/model.obj"></a-asset-item>
        <!-- Towel -->
        <a-asset-item id="towel-mtl" src="./blocks/towel/materials.mtl"></a-asset-item>
        <a-asset-item id="towel-obj" src="./blocks/towel/model.obj"></a-asset-item>
        <!-- Water -->
        <a-asset-item id="water-mtl" src="./blocks/water/materials.mtl"></a-asset-item>
        <a-asset-item id="water-obj" src="./blocks/water/model.obj"></a-asset-item>
        <!-- Table -->
        <a-asset-item id="table-mtl" src="./blocks/table/materials.mtl"></a-asset-item>
        <a-asset-item id="table-obj" src="./blocks/table/model.obj"></a-asset-item>
        <!-- Chair -->
        <a-asset-item id="chair-mtl" src="./blocks/chair/materials.mtl"></a-asset-item>
        <a-asset-item id="chair-obj" src="./blocks/chair/model.obj"></a-asset-item>
        <!-- Plant -->
        <a-asset-item id="plant-mtl" src="./blocks/plant/materials.mtl"></a-asset-item>
        <a-asset-item id="plant-obj" src="./blocks/plant/model.obj"></a-asset-item>
        <!-- Book Shelf -->
        <a-asset-item id="bookshelf-mtl" src="./blocks/bookshelf/materials.mtl"></a-asset-item>
        <a-asset-item id="bookshelf-obj" src="./blocks/bookshelf/model.obj"></a-asset-item>
        <!-- Phone -->
        <a-asset-item id="phone-mtl" src="./blocks/phone/materials.mtl"></a-asset-item>
        <a-asset-item id="phone-obj" src="./blocks/phone/model.obj"></a-asset-item>
        <!-- Photo -->
        <a-asset-item id="photo-mtl" src="./blocks/photo/materials.mtl"></a-asset-item>
        <a-asset-item id="photo-obj" src="./blocks/photo/model.obj"></a-asset-item>
        <!-- Book -->
        <a-asset-item id="book-mtl" src="./blocks/book/materials.mtl"></a-asset-item>
        <a-asset-item id="book-obj" src="./blocks/book/model.obj"></a-asset-item>
        <!-- TV -->
        <a-asset-item id="tv-mtl" src="./blocks/television/materials.mtl"></a-asset-item>
        <a-asset-item id="tv-obj" src="./blocks/television/model.obj"></a-asset-item>
        <!-- TV Bench -->
        <a-asset-item id="bench-mtl" src="./blocks/bench/materials.mtl"></a-asset-item>
        <a-asset-item id="bench-obj" src="./blocks/bench/model.obj"></a-asset-item>
        <!-- Dress -->
        <a-asset-item id="dress-mtl" src="./blocks/dress/materials.mtl"></a-asset-item>
        <a-asset-item id="dress-obj" src="./blocks/dress/model.obj"></a-asset-item>
        <!-- envelope -->
        <a-asset-item id="envelope-mtl" src="./blocks/envelope/materials.mtl"></a-asset-item>
        <a-asset-item id="envelope-obj" src="./blocks/envelope/model.obj"></a-asset-item>
        <!-- document -->
        <a-asset-item id="document-mtl" src="./blocks/document/materials.mtl"></a-asset-item>
        <a-asset-item id="document-obj" src="./blocks/document/model.obj"></a-asset-item>
        <!-- art -->
        <a-asset-item id="art-mtl" src="./blocks/art/materials.mtl"></a-asset-item>
        <a-asset-item id="art-obj" src="./blocks/art/model.obj"></a-asset-item>
        <!-- John -->
        <a-asset-item id="pony-mtl" src="./blocks/pony/materials.mtl"></a-asset-item>
        <a-asset-item id="pony-obj" src="./blocks/pony/model.obj"></a-asset-item>
        <!-- Jane -->
        <a-asset-item id="girl-mtl" src="./blocks/girl/materials.mtl"></a-asset-item>
        <a-asset-item id="girl-obj" src="./blocks/girl/model.obj"></a-asset-item>
        <!-- hand -->
        <a-asset-item id="hand-mtl" src="./blocks/hand/materials.mtl"></a-asset-item>
        <a-asset-item id="hand-obj" src="./blocks/hand/model.obj"></a-asset-item>
        <!-- heart icon -->
        <img id="heart" src="img/heart.png">
      </a-assets>

    <!-- Start Scene -->
    <a-entity id="scene-start" visible="true">
      <a-entity id="light-ambient" light="type: ambient; intensity: 1; color: #BBB"></a-entity>
      <a-entity position="6 3 2" geometry="primitive: plane; height: 1; width: 3.6" material="color:black" text="width: 14; color: white; align: center; value: METAMORPHOSIS"></a-entity>
      <a-entity position="6 1 2" geometry="primitive: plane; height: 1; width: 3.6" material="color:white" text="width: 14; color: black; align: center; value: WAKE UP" onclick="switchToMainScene()"></a-entity>
      <a-sky color="#000000"></a-sky>
    </a-entity>
    <!-- End of Start Scene -->

    <!-- Main Scene -->
    <a-entity id="scene-main" visible="false">

    <a-entity light="type: ambient; color: #FFF; intensity: 0.1"></a-entity>
    <a-entity light="type: directional; color: #FFF; intensity: 0.4" position="-0.5 1 1"></a-entity>

      <!-- Tiles for teleport -->
      <a-plane class="tile" position="-5.041 0.01 5.025" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node="transition: move"></a-plane>
      <a-plane class="tile" position="-5.041 0.01 10.98" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node="transition: move"></a-plane>
      <a-plane class="tile" position="-5.041 0.01 -10.98" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node="transition: move"></a-plane>
      <a-plane class="tile" position="-0.397 0.01 5.041" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node="transition: move"></a-plane>
      <a-plane class="tile" position="-5.041 0.01 -0.19" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node="transition: move"></a-plane>
      <a-plane class="tile" position="-0.346 0.01 -0.19" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node="transition: move"></a-plane>
      <a-plane class="tile" position=" 4.472 0.01 -0.19" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node="transition: move"></a-plane>
      <a-plane class="tile" position="-5.041 0.01 -4.94" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node="transition: move"></a-plane>
      <a-plane class="tile" position="-0.28 0.01 -4.94" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node="transition: move"></a-plane>
      <a-plane class="tile" position=" 4.60  0.01 -4.94" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node="transition: move"></a-plane>

      <a-plane position="0 0 0" rotation="-90 0 0" width="15" height="15" color="#333333">
        <!-- Room Walls -->
        <a-box position="8 0 4" rotation="0 0 0" geometry="width: 1; height: 17; depth: 8" color="#e3e3e3"></a-box>
        <a-box position="-8 0 4" rotation="0 0 0" geometry="width: 1; height: 27; depth: 8" color="#e3e3e3"></a-box>
        <a-box position="2 8 4" rotation="0 0 90" geometry="width: 1; height: 11; depth: 8" color="#e3e3e3"></a-box>
        <a-box position="2 -8 4" rotation="0 0 90" geometry="width: 1; height: 11; depth: 8" color="#e3e3e3"></a-box>

        <a-box position="-7 -8 4" rotation="0 0 90" geometry="depth:8" color="#e3e3e3"></a-box>
        <a-box position="-7 8 4" rotation="0 0 90" geometry="depth:8" color="#e3e3e3"></a-box>
        <a-box position="-5 -8 7" rotation="0 0 90" geometry="height:3;depth:2" color="#e3e3e3"></a-box>
        <a-box position="-5 8 7" rotation="0 0 90" geometry="depth:2;height:3" color="#e3e3e3"></a-box>

        <!-- <a-box position="6.1 5 3" geometry="width:2.5;depth:6;height:5" color="#e3e3e3"></a-box> -->
        <!-- Room Objects -->
        <a-entity obj-model="obj:#bed-obj;mtl:#bed-mtl;" position="5.7 -5.5 1" rotation="52 -90 -90" scale="6 6 6" travel-node="transition: move"></a-entity>
        <a-entity obj-model="obj:#nightstand-obj;mtl:#nightstand-mtl" position="3.2 -7 0.5" rotation="180 -90 -90" scale="0.5 0.5 0.5"></a-entity>
        <a-entity obj-model="obj:#water-obj;mtl:#water-mtl" position="3.2 -7 1.58" rotation="180 -90 -90" scale="2 2 2" water-cup></a-entity>
        <a-entity obj-model="obj:#table-obj;mtl:#table-mtl;" position="-6.5 0 2.2" rotation="0 -90 -90" scale="0.8 0.8 0.8"></a-entity>
        <a-entity obj-model="obj:#chair-obj;mtl:#chair-mtl;" position="-3.5 2 0.5" rotation="0 -180 -30" scale="1.5 1.5 1.5"></a-entity>
        <a-entity obj-model="obj:#plant-obj;mtl:#plant-mtl;" position="-1.75 6.5 0.8" rotation="90 0 0" scale="3 3 3"></a-entity>
        <a-entity obj-model="obj:#bookshelf-obj;mtl:#bookshelf-mtl;" position="1 6.9 2.3" rotation="-90 0 0" scale="2 2 2"></a-entity>
        <a-entity obj-model="obj:#phone-obj;mtl:#phone-mtl;" position="-5.5 -0.5 2.15" rotation="0 180.02333923010465 -45" scale="0.5 0.5 0.5"></a-entity>
        <a-entity obj-model="obj:#photo-obj;mtl:#photo-mtl;" position="-7.2 0 4" rotation="90 0 0" scale="1.5 1.5 1.5"></a-entity>
        <a-entity obj-model="obj:#book-obj;mtl:#book-mtl;" position="2 0 0.15" rotation="90 0 0" scale="1.5 1.5 1.5"></a-entity>
        <a-entity obj-model="obj:#tv-obj;mtl:#tv-mtl;" position="4.5 7 1.9" rotation="0 90 90" scale="1.5 1.5 1.5"></a-entity>
        <a-entity obj-model="obj:#bench-obj;mtl:#bench-mtl;" position="4.5 6.5 1" rotation="90 0 0" scale="5 5 5"></a-entity>
        <a-entity obj-model="obj:#dress-obj;mtl:#dress-mtl;" position="-0.5 -6 1.5" rotation="0 90 90" scale="1.5 1.5 1.5"></a-entity>
        <a-entity obj-model="obj:#envelope-obj;mtl:#envelope-mtl;" position="0 -6.5 0.009" rotation="-30 90 -90" scale="0.5 0.5 0.5"></a-entity>
        <a-entity obj-model="obj:#document-obj;mtl:#document-mtl;" position="2 2.5 0.1" rotation="-90 0 0" scale="6 6 6"></a-entity>
        <a-entity obj-model="obj:#document-obj;mtl:#document-mtl;" position="4 -2.5 0.1" rotation="-90 0 0" scale="6 6 6"></a-entity>
        <a-entity obj-model="obj:#document-obj;mtl:#document-mtl;" position="-2 5 0.1" rotation="-90 0 0" scale="6 6 6"></a-entity>
        <a-entity obj-model="obj:#art-obj;mtl:#art-mtl;" position="-7.4 -5 4.5" rotation="0 -90 90" scale="6 6 6"></a-entity>
      </a-plane>

      <!-- Bathroom Scene -->
      <a-plane position="-4.5 0 10.5" rotation="-90 0 0" width="6" height="6" color="#333333">
        <!-- Room Walls -->
        <a-box position="3.5 -1 4" rotation="0 0 90" geometry="width:6;depth:8" color="#e3e3e3"></a-box>
        <a-box position="-0.5 -3.5 4" geometry="width:7;depth:8" color="#e3e3e3"></a-box>

        <!-- Room Door -->
        <a-box position="0.15 1.5 3" rotation="0 0 60" geometry="depth:6;height:0.2;width:3" material="color:#3a4652" animation=""></a-box>

        <!-- Room Object -->
        <a-entity obj-model="obj:#toilet-obj;mtl:#toilet-mtl;" position="2 -2 1.5" rotation="90 0 0" scale="5 5 5"></a-entity>
        <a-entity obj-model="obj:#toilet_paper-obj;mtl:#toilet_paper-mtl;" position="0.85 -2.5 1.5" rotation="-90 -90 -90" scale="1.5 1.5 1.5"></a-entity>
        <a-entity obj-model="obj:#towel-obj;mtl:#towel-mtl;" position="2.6 0.5 3.5" rotation="-90 -90 -90"></a-entity>
      </a-plane>

      <!-- Entrance Scene -->
      <a-plane position="-4.5 0 -10.5" rotation="-90 0 0" width="6" height="6" color="#333333">
        <a-box position="3.5 1 4" rotation="0 0 90" geometry="width:6;depth:8" color="#e3e3e3"></a-box>

        <!-- Room Door -->
         <a-box position="0.15 -3.8 3" rotation="0 0 60" geometry="depth:6;height:0.2;width:3" material="color:#3a4652" animation=""></a-box>
      </a-plane>
      
      <!-- Mirror in toilet -->
      <a-entity position="-7.4 3 11">
        <a-box position="-0.2 0 0" width=0.5" height="3.5" depth="3.5" material="color: #3a4652;"></a-box>
        <a-box mirror="resolution: 512; repeat: true;" width="0.2" height="3" depth="3"></a-box>
      </a-entity>

      <!-- Jane -->
      <a-entity position="-2.1 1.8 -3.39" rotation="0 -120 0">
        <a-entity obj-model="obj:#girl-obj;mtl:#girl-mtl;" scale="20 20 20"></a-entity>
        <a-entity rotation="0 180 0">
            <a-entity id="button-defense" position="-1.6 1 1" geometry="primitive: plane; height: 0.5; width: 1.8" material="color:white; opacity: 0.8" text="width: 8; color: black; align: center; value: DEFENSE" defense></a-entity>
            <a-entity id="button-talk" position="1.2 1 1" geometry="primitive: plane; height: 0.5; width: 1" material="color:white; opacity: 0.8" text="width: 8; color: black; align: center; value: TALK" talk></a-entity>
            <a-entity id="combat-text" position="0 0.2 1" geometry="primitive: plane; height: 0.5; width: 3" material="color:black; opacity: 0.8" text="width: 8; color: white; align: center; value: Choose an action!"></a-entity>
      </a-entity>
      </a-entity>

      <!-- Sky -->
      <a-sky color="#333"></a-sky>

      <!-- Event Use Plane -->
      <a-plane id="event-plane" position="0 0 -20" material="opacity:0">
        <!-- water animation -->
        <a-entity id="water-cup-hand-wake" visibile="false" obj-model="obj:#water-obj;mtl:#water-mtl" position="0 0.25 -2.5" rotation="50 50 50" scale="4 4 4"></a-entity>
        <a-entity id="event-text" position="0 -0.25 -1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color: #333333" text="width:2; color: white; align: center; value: Okay, this feels better."></a-entity>
        <a-entity id="action-text" position="0 -0.5 -1.5" geometry="primitive: plane; height: 0.1; width: 0.5" material="color: white; opacity: 0.5;" text="width: 1;color: black; align: center; value: PUT BACK"></a-entity>
      </a-plane>

      </a-entity>
      <!-- End of Main Scene -->

      <!-- Ending Scene -->
      <a-entity id="scene-end" visible="false">
          <a-sky color="#EC0000"></a-sky>
      </a-entity>
      <!-- End of Ending Scene -->


      <a-camera position="6 1 5.4" id="camera">
        <a-entity id='cursor' position="0 0 -1" geometry="primitive: ring; radiusOuter: 0.03; radiusInner: 0.02;" material="color: black; shader: flat" cursor="maxDistance: 30; fuse: true">
          <a-entity geometry="primitive: ring; radiusOuter: 0.035; radiusInner: 0.015;" material="color: white; shader: flat"></a-entity>
          <a-animation begin="click" easing="ease-in" attribute="scale" fill="backwards" from="0.2 0.2 0.2" to="1 1 1" dur="150"></a-animation>
          <a-animation begin="fusing" easing="ease-in" attribute="scale" fill="forwards" from="1 1 1" to="0.2 0.2 0.2" dur="1500"></a-animation>
        </a-entity>
        <a-entity id="light-point" light="type: point; color: #000; intensity: 0.8" position="0 0 -1">
            <a-animation begin="light-on" attribute="light.color" from="#000" to="#FFF" dur="1000"></a-animation>
        </a-entity>
        <!-- Self model for mirror -->
        <a-entity position="0 -1 2">
          <a-entity obj-model="obj:#pony-obj;mtl:#pony-mtl;" position="0 0 0" rotation="0 90 0" scale="6 6 6"></a-entity>
        </a-entity>
        <!-- heart indicator -->
        <a-entity position="-2 1.2 -2">
            <a-image src="#heart" width="0.2" height="0.2"></a-image>
        </a-entity>
        <!-- Fist animation in combat -->
        <a-entity position="0 0 -0.5">
          <a-entity id="hit-hand" visible="false" obj-model="obj:#hand-obj;mtl:#hand-mtl;" position="0 0 0" rotation="7 -160 -95" scale="1 1 1">
            <a-animation begin="hit" attribute="position" from="-1 0 -1" to="2 0 2" duration="20000"></a-animation>
          </a-entity>
        </a-entity>
        <a-entity id="camera-text" visible="false" position="0 -0.25 -1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color: #333333" text="width:1; color: white; align: center; value: Oh god, my throat burns like hell. I need some water."></a-entity>
        <a-entity id="help-text" visible="false" position="0 -0.5 -1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color: white; opacity:0.5;" text="width:1; color: black; align: center; value: Gaze at the water to drink."></a-entity>
      </a-camera>
    </a-scene>

    <script src="js/aframe/travel-node.js"></script>
    <script src="js/aframe/travel-node-defaults.js"></script>
    <script src="js/aframe/aframe-mirror-component.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/scene-switch.js"></script>
    <script src="js/teleport.js"></script>
    <script src="js/pickup.js"></script>
    <script src="js/combat.js"></script>
  </body>
</html>
