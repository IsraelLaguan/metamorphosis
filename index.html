<html>
  <head>
    <meta charset="utf-8">
    <script src="https://aframe.io/releases/0.6.1/aframe.min.js"></script>
  </head>
  <body>
    <a-scene travel-node-default="axis: x,y,z; offsetY: 0.75">

      <!-- Assets Management -->
      <a-assets>
        <!-- heart icon -->
        <img id="heart" src="img/heart.png">
      </a-assets>

    <!-- Start Scene -->
    <a-entity id="scene-start" visible="true">
      <a-entity id="light-ambient" light="type: ambient; intensity: 1; color: #BBB"></a-entity>
      <a-entity position="6 3 2" geometry="primitive: plane; height: 1; width: 3.6" material="color:black" text="width: 14; color: white; align: center; value: METAMORPHOSIS"></a-entity>
      <a-entity position="6 1 2" geometry="primitive: plane; height: 1; width: 3.6" material="color:white" text="width: 14; color: black; align: center; value: WAKE UP" onclick="switchToMainScene()" hover-effect></a-entity>
      <a-sky color="#000000"></a-sky>
    </a-entity>
    <!-- End of Start Scene -->

    <!-- Main Scene -->
    <a-entity id="scene-main" visible="false">

    <a-entity light="type: ambient; color: #FFF; intensity: 0.1"></a-entity>
    <a-entity light="type: directional; color: #FFF; intensity: 0.4" position="-0.5 1 1"></a-entity>

      <!-- Tiles for teleport -->
      <a-plane class="tile" position="-5 0.01 4" rotation="-90 0 0" width="4" height="2" color="#444444" teleport-listener travel-node></a-plane>
      <a-plane class="tile" position="-0.4 0.01 4" rotation="-90 0 0" width="4" height="2" color="#444444" teleport-listener travel-node></a-plane>
      <a-plane class="tile" position="-3.5 0.01 0" rotation="-90 0 0" width="1" height="4" color="#444444" teleport-listener travel-node></a-plane>
      <a-plane class="tile" position="-0.4 0.01 0" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node></a-plane>
      <a-plane class="tile" position=" 4.6 0.01 0" rotation="-90 0 0" width="4" height="4" color="#444444" teleport-listener travel-node></a-plane>
      <a-plane class="tile" position="-5 0.01 -4" rotation="-90 0 0" width="4" height="2" color="#444444" teleport-listener travel-node></a-plane>
      <a-plane class="tile" position="0 0.01 -4" rotation="-90 0 0" width="4" height="2" color="#444444" teleport-listener travel-node></a-plane>
      <a-plane class="tile" position=" 4.6  0.01 -4" rotation="-90 0 0" width="4" height="2" color="#444444" teleport-listener travel-node></a-plane>

      <a-plane position="0 0 0" rotation="-90 0 0" width="15" height="15" color="#333333">
        <!-- Room Walls -->
        <a-box position="8 0 4" rotation="0 0 0" geometry="width: 1; height: 17; depth: 8" color="#e3e3e3"></a-box>
        <a-box position="-8 0 4" rotation="0 0 0" geometry="width: 1; height: 27; depth: 8" color="#e3e3e3"></a-box>
        <a-box position="2 8 4" rotation="0 0 90" geometry="width: 1; height: 11; depth: 8" color="#e3e3e3"></a-box>
        <a-box position="2 -8 4" rotation="0 0 90" geometry="width: 1; height: 11; depth: 8" color="#e3e3e3"></a-box>

        <a-box position="-7 -8 4" rotation="0 0 90" geometry="depth:8" color="#e3e3e3"></a-box>
        <a-box position="-7 8 4" rotation="0 0 90" geometry="depth:8" color="#e3e3e3"></a-box>
        <a-box position="-5 -8 7" rotation="0 0 90" geometry="height:3;depth:2" color="#e3e3e3"></a-box>
        <a-box position="-5 8 7" rotation="0 0 90" geometry="depth:2;height:3" color="#e3e3e3"></a-box>

        <!-- <a-box position="6.1 5 3" geometry="width:2.5;depth:6;height:5" color="#e3e3e3"></a-box> -->
        <!-- Room Objects -->
        <!-- bed -->
        <a-entity >
          <a-box position="5.77 -5 0.251" geometry="height:4.5;depth:0.5;width:3.5" color="#e3e3e3" material="color:#000000"></a-box>
          <a-box position="5.77 -5 0.8" geometry="depth:0.5;height:4.5;width:3.5" color="#e3e3e3" material="color:#ffffff"></a-box>
          <a-box position="5.77 -7.32 0.251" geometry="height:0.5;depth:3;width:3.5" color="#e3e3e3" material="color:#000000"></a-box>
        </a-entity>
        <!-- paper on floor -->
        <a-entity paper hover-effect position="3.482 -1.342 0.01">
          <a-box position="0 0 0.01" geometry="width:0.7;height:0.5;depth:0.05" color="#e3e3e3" material="color:#FFF"></a-box>
          <a-box position="0 0 0" rotation="0 0 -18.850311459804086" geometry="depth:0.05;height:0.5;width:0.7" color="#e3e3e3" material="color:#FFF"></a-box>
        </a-entity>
        <a-entity paper="" hover-effect="" position="1.629 2.577 0.01">
          <a-box position="0 0 0.01" geometry="depth:0.05;height:0.5;width:0.7" color="#e3e3e3" material="color:#FFF"></a-box>
          <a-box rotation="0 0 -18.850311459804086" geometry="depth:0.05;height:0.5;width:0.7" color="#e3e3e3" material="color:#FFF"></a-box>
        </a-entity>
        <a-entity paper="" hover-effect="" position="3.01 5.002 0.01">
          <a-box position="0 0 0.01" geometry="depth:0.05;height:0.5;width:0.7" color="#e3e3e3" material="color:#FFF"></a-box>
          <a-box rotation="0 0 -18.850311459804086" geometry="depth:0.05;height:0.5;width:0.7" color="#e3e3e3" material="color:#FFF"></a-box>
        </a-entity>
        <!-- night stand -->
        <a-entity night-stand hover-effect position="3.2 -7 0.5">
          <a-box material="color:#000000" geometry="width:1.5;depth:1.75"></a-box>
          <a-box position="0.053 0.48 0.472" material="color:#fff" geometry="width:0.3;height:0.1;depth:0.05"></a-box>
          <a-box position="0.053 0.48 0.013" material="color:#fff" geometry="depth:0.05;height:0.1;width:0.3"></a-box>
        </a-entity>
        <!-- water -->
        <a-entity water-cup hover-effect position="3.2 -7 1.58">
          <a-cylinder rotation="90.01166961505233 0 0" material="" geometry="height:0.4;radius:0.15"></a-cylinder>
          <a-circle position="0.037 0.003 0.215" material="color:#00ffff" geometry="radius:0.13"></a-circle>
        </a-entity>
        <!-- table -->
        <a-entity position="-6.5 0 2.2">
          <a-box position="0.481 0 -0.284" material="color:#996633" geometry="depth:0.3;width:3;height:5"></a-box>
          <a-box position="1.818 -2.344 -1.202" material="color:#996633" geometry="depth:2;height:0.3;width:0.3"></a-box>
          <a-box position="-0.842 -2.344 -1.202" material="color:#996633" geometry="depth:2;height:0.3;width:0.3"></a-box>
          <a-box position="1.844 2.319 -1.202" material="color:#996633" geometry="depth:2;height:0.3;width:0.3"></a-box>
          <a-box position="-0.842 2.367 -1.202" material="color:#996633" geometry="depth:2;height:0.3;width:0.3"></a-box>
        </a-entity>
        <!-- plant -->
        <a-entity plant hover-effect position="-1.75 6.5 0.8">
          <a-box></a-box>
        </a-entity>
        <!-- book shelf -->
        <a-entity position="1 6.9 2.3">
          <a-box></a-box>
        </a-entity>
        <!-- phone -->
        <a-entity phone id="phone" position="-5.5 -0.5 2.15">
          <a-box position="0 0 -0.066" material="color:#333" geometry="height:0.3;width:0.5;depth:0.05"></a-box>
          <a-animation begin="phone-ring" end="phone-end" attribute="scale" dur="1000" from="0.5 0.5 0.5" to="0.8 0.8 0.8" repeat="indefinite"></a-animation>
        </a-entity>
        <!-- book -->
        <a-entity book hover-effect position="2 0 0.15">
          <a-box position="0 0 -0.087" material="color:#800080" geometry="width:0.8;height:0.6;depth:0.12"></a-box>
          <a-box position="0 0 0.031" material="color:#6d5cae" geometry="depth:0.12;height:0.6;width:0.8" rotation="0 0 -14.495832216809827"></a-box>
        </a-entity>
        <!-- TV -->
        <a-entity position="4.5 7 1.9">
          <a-box></a-box>
        </a-entity>
        <!-- bench -->
        <a-entity position="4.5 6.5 1">
          <a-box></a-box>
        </a-entity>
        <!-- dress -->
        <a-entity position="-0.5 -6 1.5">
          <a-box position="0.726 -1.005 -0.252" material="color:#333333" geometry="width:4;depth:2.5"></a-box>
          <a-box position="0.726 -0.644 0.655" material="color:#804000" geometry="depth:0.1;height:0.4"></a-box>
          <a-box position="0.726 -0.644 0.006" material="color:#804000" geometry="depth:0.1;height:0.4"></a-box>
          <a-box position="0.726 -0.644 -0.686" material="color:#804000" geometry="depth:0.1;height:0.4"></a-box>
        </a-entity>
        <!-- envelope -->
        <a-entity envelope hover-effect position="0 -6.5 0.009">
          <a-box rotation="0 0 -39.5340878640268" material="color:#996633" geometry="width:0.8;depth:0.05"></a-box>
        </a-entity>
        <!-- painting -->
        <a-entity painting position="-7.4 -5 4.5">
          <a-box position="-0.114 0 0" material="color:#000000" geometry="height:3;width:0.2;depth:4"></a-box>
          <a-box position="-0.048 0.57 0.994" material="color:#ff0000" geometry="depth:2;width:0.2"></a-box>
          <a-box position="-0.048 -0.165 -0.633" material="color:#ffffff" geometry="depth:2;width:0.2"></a-box>
          <a-box position="-0.048 -1.003 0.266" material="color:#ffff00" geometry="depth:2;width:0.2"></a-box>
        </a-entity>
        <!-- mail -->
        <a-entity id="mail" visible="false" mail-floor position="-7 -5 0.1">
          <a-box rotation="0 0 -39.534" material="color:#ff8000" geometry="width:0.5;height:0.8;depth:0.05"></a-box>
        </a-entity>
      </a-plane>

      <!-- Bathroom Scene -->
      <a-plane position="-4.5 0 10.5" rotation="-90 0 0" width="6" height="6" color="#333333">
        <!-- Room Walls -->
        <a-box position="3.5 -1 4" rotation="0 0 90" geometry="width:6;depth:8" color="#e3e3e3"></a-box>
        <a-box position="-0.5 -3.5 4" geometry="width:7;depth:8" color="#e3e3e3"></a-box>

        <!-- Toilet Door -->
        <a-box toilet-door position="-0.55 2.8 3" rotation="0 0 0" geometry="depth:6;height:0.2;width:3" material="color:#3a4652" animation=""></a-box>

        <!-- Toilet Object -->
        <a-entity toilet hover-effect obj-model="obj:#toilet-obj;mtl:#toilet-mtl;" position="2 -2 1.5" rotation="90 0 0" scale="5 5 5"></a-entity>
      </a-plane>

      <!-- Entrance Scene -->
      <a-plane position="-4.5 0 -10.5" rotation="-90 0 0" width="6" height="6" color="#333333">
        <a-box position="3.5 1 4" rotation="0 0 90" geometry="width:6;depth:8" color="#e3e3e3"></a-box>

        <!-- Room Door -->
         <a-box front-door position="-0.55 -2.2 3" rotation="0 0 0" geometry="depth:6;height:0.2;width:3" material="color:#3a4652" animation=""></a-box>
      </a-plane>

      <!-- Mirror in toilet -->
      <a-entity look-at-mirror position="-7.4 2.5 11">
        <a-box position="-0.2 0 0" width="0.5" height="3.5" depth="3.5" material="color: #3a4652;"></a-box>
        <a-box mirror="resolution: 512; repeat: true;" width="0.2" height="3" depth="3"></a-box>
      </a-entity>

      <!-- Jane -->
      <a-entity position="-4.5 1.5 -12" rotation="0 180 0">
        <a-entity obj-model="obj:#girl-obj;mtl:#girl-mtl;" scale="10 10 10"></a-entity>
        <a-entity rotation="0 180 0">
            <a-entity id="button-defense" position="-0.5 0.5 1.5" geometry="primitive: plane; height: 0.2; width: 0.5" material="color:white; opacity: 0.8" text="width: 1; color: black; align: center; value: DEFENSE" defense hover-effect></a-entity>
            <a-entity id="button-talk" position="0.5 0.5 1.5" geometry="primitive: plane; height: 0.2; width: 0.5" material="color:white; opacity: 0.8" text="width: 1; color: black; align: center; value: TALK" talk hover-effect></a-entity>
            <a-entity id="combat-text" position="0 0.2 1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color:black; opacity: 0.8" text="width: 1; color: white; align: center; value: OMG! What a monster!"></a-entity>
            <a-entity id="button-end" visible="false" position="0 0 1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color:white; opacity: 0.8" text="width: 1; color: black; align: center; value: END GAME" onclick="switchToEndScene()" hover-effect></a-entity>
            <!-- heart indicator -->
            <a-entity position="-0.2 -0.2 1">
                <a-image id="jane_heart_1" position="-0.2 0.5 1" src="#heart" width="0.05" height="0.05"></a-image>
                <a-image id="jane_heart_2" position="0 0.5 1" src="#heart" width="0.05" height="0.05"></a-image>
                <a-image id="jane_heart_3" position="0.2 0.5 1" src="#heart" width="0.05" height="0.05"></a-image>
            </a-entity>
        </a-entity>
      </a-entity>

      <!-- Sky -->
      <a-sky color="#333"></a-sky>

      <!-- Event Use Plane -->
      <a-plane id="event-plane" position="0 0 -20" material="opacity:0">
        <!-- elements -->
        <a-entity id="water-cup-hand" visible="false" obj-model="obj:#water-obj;mtl:#water-mtl" position="0 0.25 -2.5" rotation="50 50 50" scale="4 4 4"></a-entity>
        <a-entity id="envelope-hand" visible="false" obj-model="obj:#envelope-obj;mtl:#envelope-mtl;" position="0 0.25 -2.5" rotation="90 -45 0" scale="0.5 0.5 0.5"></a-entity>
        <a-entity id="phone-hand" visible="false" obj-model="obj:#phone-obj;mtl:#phone-mtl;" position="0.03 0.4 -2" rotation="0 180 0" scale="0.5 0.5 0.5"></a-entity>
        <a-entity id="night-stand-hand" visible="false" obj-model="obj:#nightstand-obj;mtl:#nightstand-mtl" position="-0.15 0.5 -3" rotation="0 -90 -15" scale="0.5 0.5 0.5"></a-entity>
        <a-entity id="paper-hand" visible="false" obj-model="obj:#document-obj;mtl:#document-mtl;" position="-0.05 0.5 -2" rotation="30 90 90" scale="4 4 4"></a-entity>
        <a-entity id="plant-hand" visible="false" obj-model="obj:#plant-obj;mtl:#plant-mtl;" position="0.03 0.4 -2" rotation="0 0 0" scale="2 2 2"></a-entity>
        <a-entity id="book-hand" visible="false" obj-model="obj:#book-obj;mtl:#book-mtl;" position="2 0 0.15" rotation="90 0 0" scale="1.5 1.5 1.5"></a-entity>
        <a-entity id="mail-hand" visible="false" obj-model="obj:#mail-obj;mtl:#mail-mtl;" position="0.05 0.5 -2" rotation="0 90 0" scale="0.5 0.5 0.5"></a-entity>
        <!-- text -->
        <a-entity id="event-text" visible="false" position="0 -0.25 -1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color: #333333" text="width:1; color: white; align: center; value: Okay, this feels better."></a-entity>
        <a-entity id="action-text" visible="false" position="0 -0.5 -1.5" geometry="primitive: plane; height: 0.1; width: 0.5" material="color: white; opacity: 0.5;" text="width: 1;color: black; align: center; value: PUT BACK"></a-entity>
        <a-entity id="action-text-primary" visible="false" position="-0.35 -0.5 -1.5" geometry="primitive: plane; height: 0.1; width: 0.5" material="color: white; opacity: 0.5;" text="width: 1;color: black; align: center; value: PUT BACK"></a-entity>
        <a-entity id="action-text-secondary" visible="false" position="0.35 -0.5 -1.5" geometry="primitive: plane; height: 0.1; width: 0.5" material="color: white; opacity: 0.5;" text="width: 1;color: black; align: center; value: PUT BACK"></a-entity>
      </a-plane>

      </a-entity>
      <!-- End of Main Scene -->

      <!-- Ending Scene -->
      <a-entity id="scene-end" visible="false">
          <a-entity id="light-ambient" light="type: ambient; intensity: 1; color: #BBB"></a-entity>
          <a-entity position="-4.5 1.5 -12" geometry="primitive: plane; height: 1; width: 3.6" material="color:black" text="width: 14; color: white; align: center; value: THE END"></a-entity>
          <a-sky color="#000000"></a-sky>
      </a-entity>
      <!-- End of Ending Scene -->


      <a-camera position="6 1 5.4" id="camera">
        <a-entity id='cursor' position="0 0 -1" geometry="primitive: ring; radiusOuter: 0.03; radiusInner: 0.02;" material="color: black; shader: flat" cursor="maxDistance: 30; fuse: true">
          <a-entity geometry="primitive: ring; radiusOuter: 0.035; radiusInner: 0.015;" material="color: white; shader: flat"></a-entity>
          <a-animation begin="click" easing="ease-in" attribute="scale" fill="backwards" from="0.2 0.2 0.2" to="1 1 1" dur="150"></a-animation>
          <a-animation begin="fusing" easing="ease-in" attribute="scale" fill="forwards" from="1 1 1" to="0.2 0.2 0.2" dur="1500"></a-animation>
        </a-entity>
        <a-entity id="light-point" light="type: point; color: #000; intensity: 0.8" position="0 0 -1">
            <a-animation begin="light-on" attribute="light.color" from="#000" to="#FFF" dur="1000"></a-animation>
            <a-animation begin="light-off" attribute="light.color" from="#FFF" to="#000" dur="1000"></a-animation>
        </a-entity>
        <!-- Self model for mirror -->
        <a-entity position="0 -1 2">
          <a-entity obj-model="obj:#pony-obj;mtl:#pony-mtl;" position="0 0 0" rotation="0 90 0" scale="6 6 6"></a-entity>
        </a-entity>
        <!-- heart indicator -->
        <a-entity position="0 0.5 -1.5" id="john_heart" visible="false">
            <a-image id="john_heart_1" position="-0.2 0 0" src="#heart" width="0.1" height="0.1"></a-image>
            <a-image id="john_heart_2" position="0 0 0" src="#heart" width="0.1" height="0.1"></a-image>
            <a-image id="john_heart_3" position="0.2 0 0" src="#heart" width="0.1" height="0.1"></a-image>
        </a-entity>
        <a-entity id="camera-text" visible="false" position="0 -0.25 -1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color: #333333" text="width:1; color: white; align: center; value: Oh God, my throat burns like hell. I need some water."></a-entity>
        <a-entity id="help-text" visible="false" position="0 -0.5 -1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color: white; opacity:0.5;" text="width:1; color: white; align: center; value: Gaze at the water to drink."></a-entity>
      </a-camera>
    </a-scene>

    <script src="js/aframe/travel-node.js"></script>
    <script src="js/aframe/travel-node-defaults.js"></script>
    <script src="js/aframe/aframe-mirror-component.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/scene-switch.js"></script>
    <script src="js/teleport.js"></script>
    <script src="js/pickup.js"></script>
    <script src="js/combat.js"></script>
  </body>
</html>
